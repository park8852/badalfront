# 바로배달(BaroBaedal) 취약점 진단 리스트

## 작성 기준
- **OWASP Top 10 (2021)**
- **주요정보통신기반시설 취약점 분석·평가 기준** (KISA)
- **웹 애플리케이션 보안 가이드** (한국인터넷진흥원)
- **ISO/IEC 27001**: 정보보안 관리체계

---

## 1. 인증 및 세션 관리 (Authentication & Session Management)

### 1.1 JWT 토큰 관리
- [ ] JWT 토큰 생성 알고리즘 안전성 검증
- [ ] 토큰 Secret Key 관리 방식 (하드코딩 여부)
- [ ] 토큰 만료 시간 적정성 (1시간 고정)
- [ ] 리프레시 토큰 구현 여부
- [ ] 토큰 블랙리스트 관리 (로그아웃 후 토큰 무효화)
- [ ] JWT Payload 변조 가능성
- [ ] 토큰 탈취 시나리오 (XSS, MITM)

### 1.2 인증 로직
- [ ] 계정 잠금 정책 (Brute Force 방지)
- [ ] 비밀번호 정책 강도
- [ ] 비밀번호 해싱 알고리즘 (BCrypt, Argon2)
- [ ] 로그인 시도 제한
- [ ] 2단계 인증(2FA) 구현 여부

---

## 2. 입력 검증 및 출력 인코딩 (Input Validation & Output Encoding)

### 2.1 SQL Injection
- [ ] Prepared Statement 사용 여부
- [ ] 동적 쿼리 생성 시 사용자 입력 검증
- [ ] 특수 문자 필터링
- [ ] 파라미터화된 쿼리 사용
- [ ] 데이터베이스 권한 최소화
- [ ] 에러 메시지 정보 노출

**테스트 케이스:**
```sql
-- 일반
admin' OR '1'='1
admin'--
' UNION SELECT null,null,null--

-- Blind
admin' AND SLEEP(5)--
admin' AND 1=1--

-- Time-based
'; WAITFOR DELAY '00:00:05'--
```

### 2.2 Cross-Site Scripting (XSS)

#### 2.2.1 Stored XSS
- [ ] 게시판 입력값 HTML 엔티티 인코딩
- [ ] 사용자 입력 저장 시 스크립트 태그 검증
- [ ] Content Security Policy (CSP) 헤더

**테스트 페이로드:**
```html
<script>alert('XSS')</script>
<img src=x onerror=alert('XSS')>
<svg onload=alert('XSS')>

<!-- Encoded -->
%3Cscript%3Ealert('XSS')%3C/script%3E
```

#### 2.2.2 Reflected XSS
- [ ] URL 파라미터 출력 시 인코딩
- [ ] 검색어 반영 시 스크립트 실행 가능성

#### 2.2.3 DOM XSS
- [ ] JavaScript 내 사용자 입력 처리
- [ ] innerHTML 사용 시 검증

### 2.3 Command Injection
- [ ] 시스템 명령어 실행 가능성
- [ ] 파이프(|), 세미콜론(;) 필터링
- [ ] 외부 프로세스 호출 시 검증

### 2.4 LDAP Injection
- [ ] LDAP 쿼리 내 사용자 입력 처리

### 2.5 XPath Injection
- [ ] XML 파싱 시 사용자 입력 검증

---

## 3. 파일 업로드 취약점

### 3.1 파일 업로드 검증
- [ ] 파일 확장자 검증 (whitelist 방식)
- [ ] MIME Type 검증
- [ ] 파일 크기 제한 (현재 10MB)
- [ ] 파일 내용 스캔 (매직 바이트 검증)
- [ ] 파일명 경로 조작 방지 (`../`, `..\\`)
- [ ] 중복 파일명 처리
- [ ] 실행 가능한 디렉터리 저장 방지

### 3.2 악성 파일 업로드 가능성
- [ ] JSP/ASP/PHP 웹쉘 업로드
- [ ] Executable 파일 실행
- [ ] 이미지 파일에 숨겨진 스크립트 (Polyglot 파일)

**테스트 파일:**
```bash
# JSP 웹쉘
<%Runtime.getRuntime().exec(request.getParameter("cmd"));%>

# 파일명 조작
../../../etc/passwd
..\\..\\..\\windows\\system32\\config\\sam
```

---

## 4. 권한 관리 및 접근 제어 (Authorization & Access Control)

### 4.1 수직 권한 상승
- [ ] 일반 사용자 → 관리자 권한 획득
- [ ] Role 기반 접근 제어(RBAC) 검증 부족
- [ ] JWT 내 Role 변조 가능성

### 4.2 수평 권한 상승
- [ ] 다른 사용자 데이터 접근
- [ ] 본인 가게만 수정 가능한지 검증
- [ ] URL 파라미터 조작 시 권한 우회

### 4.3 IDOR (Insecure Direct Object Reference)
- [ ] 민감한 리소스 직접 참조
- [ ] 예측 가능한 식별자 사용
- [ ] 소유권 검증 없음

**테스트 시나리오:**
```
GET /api/member/info?id=1
GET /api/order/123  (다른 사용자 주문 접근)
GET /api/store/info?storeId=999  (본인 가게가 아닌 정보 접근)
```

---

## 5. 비즈니스 로직 취약점

### 5.1 포인트 시스템
- [ ] 포인트 충전 시 금액 검증 부족
- [ ] 음수 포인트 입력 가능
- [ ] 무제한 포인트 충전 가능
- [ ] 실제 결제 연동 없음
- [ ] 포인트 중복 적립

### 5.2 주문 시스템
- [ ] 주문 가격 조작 가능
- [ ] 수량 음수 입력
- [ ] 가격 totalPrice 직접 변경 가능
- [ ] 주문 취소/환불 로직 취약

### 5.3 정산 시스템
- [ ] 정산 금액 조작
- [ ] 가게 주인 아닌 사람의 정산 정보 접근
- [ ] 이중 지급 방지

---

## 6. 암호화 및 키 관리

### 6.1 데이터 암호화
- [ ] 민감정보 암호화 저장 (신용카드, 계좌번호)
- [ ] 암호화 키 관리 (하드코딩 여부)
- [ ] 전송 중 데이터 암호화 (HTTPS)
- [ ] 데이터베이스 암호화

### 6.2 비밀번호 관리
- [ ] 단방향 해싱 (BCrypt, Argon2)
- [ ] 솔트(Salt) 사용
- [ ] 단순 해시 알고리즘 사용 금지 (MD5, SHA1)

### 6.3 키 관리
- [ ] JWT Secret Key 하드코딩
- [ ] 키 로테이션 정책
- [ ] 키 저장소 안전성

---

## 7. 로깅 및 모니터링

### 7.1 로깅
- [ ] 민감정보 로깅 (비밀번호, 신용카드)
- [ ] 로그 파일 접근 제어
- [ ] 로그 로테이션 정책
- [ ] 보안 이벤트 로깅 (로그인 실패, 권한 변경)

### 7.2 모니터링
- [ ] 실시간 침입 탐지
- [ ] 이상 트래픽 탐지
- [ ] API 호출 빈도 제한 (Rate Limiting)
- [ ] 관리자 권한 변경 알림

---

## 8. 오류 처리 및 정보 노출

### 8.1 오류 메시지
- [ ] 스택 트레이스 노출
- [ ] 데이터베이스 구조 노출
- [ ] 시스템 버전 정보 노출
- [ ] 상세한 오류 메시지

### 8.2 디버그 모드
- [ ] 운영 환경 디버그 모드 활성화
- [ ] 상세한 예외 정보 출력

---

## 9. 설정 및 배포

### 9.1 보안 설정
- [ ] 기본 관리자 계정 존재
- [ ] 불필요한 서비스 실행
- [ ] CORS 설정
- [ ] HTTPS 강제 설정

### 9.2 의존성 관리
- [ ] 취약한 라이브러리 사용 (Struts, Log4j)
- [ ] 의존성 업데이트 누락
- [ ] 라이선스 위반 의존성

---

## 10. API 보안

### 10.1 REST API 보안
- [ ] HTTP 메서드 적절성 (GET에서 수정 작업 수행)
- [ ] Sex Identification Rate Limiting
- [ ] API 키 관리
- [ ] CORS 설정

### 10.2 GraphQL 보안 (해당 시)
- [ ] Query Depth 제한
- [ ] Query Complexity 제한
- [ ] Introspection 비활성화

---

## 우선순위

### 🔴 Critical (긴급)
1. SQL Injection
2. 인증 우회
3. 비즈니스 로직 취약점 (포인트 조작)
4. 파일 업로드 보안
5. XSS (Stored)

### 🟡 High (높음)
6. 권한 상승 (수직/수평)
7. JWT 토큰 관리
8. 민감정보 암호화
9. 로깅 정보 노출

### 🟢 Medium (중간)
10. 비밀번호 정책
11. Rate Limiting
12. CORS 설정
13. 로깅 및 모니터링

### 🔵 Low (낮음)
14. 에러 메시지 개선
15. 디버그 모드 비활성화
16. 의존성 업데이트

---

## 참고 자료

### 국제 표준
- **OWASP Top 10 (2021)**: https://owasp.org/www-project-top-ten/
- **CWE Top 25**: https://cwe.mitre.org/top25/

### 국내 가이드
- **KISA 취약점 분석·평가 기준**: https://www.kisa.or.kr
- **개인정보보호법**
- **정보통신망법**

### 도구
- **Burp Suite**: 웹 애플리케이션 침투 테스트
- **OWASP ZAP**: 웹 보안 스캐너
- **SQLMap**: SQL Injection 자동화 도구
- **Nessus**: 취약점 스캐너

